const CHARS="abcdefghijklmnopqrstuvwxyz'",VOWELS="aeiou",CONSONANTS="bcdfghjklmnpqrstvwxyz",DATA_MAPPING=["S|2|0","S|3|0","E|2|0","E|3|0","G|2|0","G|3|0","O|1|0"],DATA_SEPARATOR=124,MAX_WORD_LENGTH=15,MIN_VOWEL_RATIO=.1,MAX_VOWEL_RATIO=.8;let MAP;const initMap=t=>{MAP=DATA_MAPPING.map((()=>[])),setMap(t)},setMap=t=>{let n=0,e=0;t.forEach(((A,i)=>{if(A==DATA_SEPARATOR)e++,n=0;else{let f=DATA_MAPPING[e].split("|"),s=f[0],o=parseInt(f[1]);if("S"==s||"E"==s||"G"==s){if(n%o==0){for(let O="",r=0;o>r;r++)O+=CHARS[t[i+r]];MAP[e].push(O)}}else"O"==s&&MAP[e].push(t[i]);n++}}))},testByLength=t=>{return t.length<MAX_WORD_LENGTH},testByData=t=>{let n={};DATA_MAPPING.forEach(((e,A)=>{e=e.split("|");let i=e[0],f=parseInt(e[1]);if(n[A]=n[A]||0,"S"==i){let s=t.substr(0,f);-1!=MAP[A].indexOf(s)&&n[A]++}else if("E"==i){let s=t.substr(-f);-1!=MAP[A].indexOf(s)&&n[A]++}else if("G"==i)for(let o=0;o<t.length-(f-1);o++){for(let s="",O=0;f>O;O++)s+=t[o+O];-1!=MAP[A].indexOf(s)&&n[A]++}else if("O"==i){for(let r={},o=0;o<t.length;o++)r[t[o]]=r[t[o]]?r[t[o]]+1:1;for(let M in r)r.hasOwnProperty(M)&&r[M]/t.length*255>MAP[A][CHARS.indexOf(M)]&&n[A]++}}));let e=!0;return DATA_MAPPING.forEach(((t,A)=>{let i=parseInt(t.split("|")[2]);n[A]>i&&(e=!1)})),e},testByVowelRatio=t=>{let n,e=t.match(new RegExp(`[${VOWELS}]`,"gi")),A=t.match(new RegExp(`[${CONSONANTS}]`,"gi"));return e=e?e.length:0,A=A?A.length:0,n=e/(e+A),n>MIN_VOWEL_RATIO&&MAX_VOWEL_RATIO>n};module.exports={init:t=>initMap(t),test:t=>testByLength(t)&&testByData(t)&&testByVowelRatio(t)};